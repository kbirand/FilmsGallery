version: '3.8'

services:
  video-gallery:
    build: .
    image: video-gallery:latest
    container_name: video-gallery
    restart: unless-stopped
    ports:
      # Map container port 3000 to host port 3000
      - "3005:3000"
    environment:
      - NODE_ENV=production
      - PORT=3000
      # Point to the internal volume mount
      - VIDEO_PATH=/app/videos
      - MP4_PATH=/app/mp4
    volumes:
      # Mount the Synology video folder (CHANGE LEFT SIDE TO YOUR NAS PATH)
      # e.g., /volume1/video/YouTubeArchive :/app/videos
      - ${VIDEO_PATH}:/app/videos

      # Persist logs and thumbnails
      - ./Logs:/app/Logs
      - ./thumbnails:/app/thumbnails

      # Mount MP4 Previews (Pre-generated)
      - ./mp4:/app/mp4

      # Mount source code to override container version (Hot Fix if needed)
      - ./server.js:/app/server.js
      # - ./services:/app/services (Removed as services folder was deleted)

      # Use the .env file for secrets
    env_file:
      - .env
